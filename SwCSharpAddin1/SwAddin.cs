using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Reflection;
using System.Runtime.InteropServices;

using SolidWorks.Interop.sldworks;
using SolidWorks.Interop.swpublished;
using SolidWorks.Interop.swconst;
using SolidWorksTools;
using SolidWorksTools.File;

using FSharp.SolidWorks;

namespace SwCSharpAddin1
{
    [ComVisible(true)]
    [Guid("43f85157-13ec-476b-a57e-02fb5973e8bb")]
    [SwAddin(
            Description = "´ÞÊ¤ÀûµÄSW²å¼þ",
            Title = "CuiShengLi",
            LoadAtStartup = true
            )]
    public class SwAddin : ISwAddin
    {
        public const int cmdGroupID = 5;

        ISldWorks iSwApp;
        public ISldWorks SwApp { get { return this.iSwApp; } }

        ICommandManager iCmdMgr;
        public ICommandManager CmdMgr { get { return this.iCmdMgr; } }

        BitmapHandler iBmp;

        [ComRegisterFunction]
        public static void RegisterFunction(Type t)
        {
            SwAddinAttribute SWattr = null;
            var typ = typeof(SwAddin);

            foreach (System.Attribute attr in typ.GetCustomAttributes(false).Cast<System.Attribute>()) {
                if (attr is SwAddinAttribute) {
                    SWattr = attr as SwAddinAttribute;
                    break;
                }
            }

            try {
                var hklm = Microsoft.Win32.Registry.LocalMachine;
                var hkcu = Microsoft.Win32.Registry.CurrentUser;

                var keyname = "SOFTWARE\\SolidWorks\\Addins\\{" + t.GUID.ToString() + "}";
                var addinkey = hklm.CreateSubKey(keyname);
                addinkey.SetValue(null, 0);

                addinkey.SetValue("Description", SWattr.Description);
                addinkey.SetValue("Title", SWattr.Title);

                keyname = "Software\\SolidWorks\\AddInsStartup\\{" + t.GUID.ToString() + "}";
                addinkey = hkcu.CreateSubKey(keyname);
                addinkey.SetValue(null, Convert.ToInt32(SWattr.LoadAtStartup), Microsoft.Win32.RegistryValueKind.DWord);
            }
            catch (System.NullReferenceException nl) {
                //Console.WriteLine("There was a problem registering this dll: SWattr is null. \n\"" + nl.Message + "\"");
                System.Windows.Forms.MessageBox.Show("There was a problem registering this dll: SWattr is null.\n\"" + nl.Message + "\"");
            }
            catch (System.Exception e) {
                //Console.WriteLine(e.Message);
                System.Windows.Forms.MessageBox.Show("There was a problem registering the function: \n\"" + e.Message + "\"");
            }
        }

        [ComUnregisterFunction]
        public static void UnregisterFunction(Type t)
        {
            try {
                var hklm = Microsoft.Win32.Registry.LocalMachine;
                var hkcu = Microsoft.Win32.Registry.CurrentUser;

                var keyname = "SOFTWARE\\SolidWorks\\Addins\\{" + t.GUID.ToString() + "}";
                hklm.DeleteSubKey(keyname);

                keyname = "Software\\SolidWorks\\AddInsStartup\\{" + t.GUID.ToString() + "}";
                hkcu.DeleteSubKey(keyname);
            }
            catch (System.NullReferenceException nl) {
                //Console.WriteLine("There was a problem unregistering this dll: " + nl.Message);
                System.Windows.Forms.MessageBox.Show("There was a problem unregistering this dll: \n\"" + nl.Message + "\"");
            }
            catch (System.Exception e) {
                //Console.WriteLine("There was a problem unregistering this dll: " + e.Message);
                System.Windows.Forms.MessageBox.Show("There was a problem unregistering this dll: \n\"" + e.Message + "\"");
            }
        }

        public bool ConnectToSW(object ThisSW, int cookie)
        {
            this.iSwApp = (ISldWorks)ThisSW;
            this.iSwApp.SetAddinCallbackInfo(0, this, cookie);

            this.iCmdMgr = this.iSwApp.GetCommandManager(cookie);
            this.AddCommandMgr();

            return true;
        }

        public bool DisconnectFromSW()
        {
            this.RemoveCommandMgr();

            Marshal.ReleaseComObject(this.iCmdMgr);
            this.iBmp.Dispose();
            Marshal.ReleaseComObject(this.iSwApp);

            //The addin _must_ call GC.Collect() here in order to retrieve all managed code pointers 
            GC.Collect();
            GC.WaitForPendingFinalizers();

            GC.Collect();
            GC.WaitForPendingFinalizers();

            return true;
        }

        public void AddCommandMgr()
        {
            //ÊÕ¼¯ÃüÁîÏîÄ¿
            var cmds = new CommandItemCollection();

            ////ÃüÁî
            //cmds.add(
            //    hintString: "training1",
            //    toolTip: "µÚ1ÕÂÊ¾Àý",
            //    callbackFunction: nameof(this.Training1),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "connect to sw",
            //    toolTip: "Í¼2-7",
            //    callbackFunction: nameof(this.Training2_3),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "new part",
            //    toolTip: "Í¼2-12",
            //    callbackFunction: nameof(this.Training2_NewModel_Part),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "new assy",
            //    toolTip: "Í¼2-12",
            //    callbackFunction: nameof(this.Training2_NewModel_ASM),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "new drw",
            //    toolTip: "Í¼2-12",
            //    callbackFunction: nameof(this.Training2_NewModel_DRW),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "New PartDoc",
            //    toolTip: "Í¼2-18",
            //    callbackFunction: nameof(this.Training2_NewPartDoc),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "New AssemblyDoc",
            //    toolTip: "Í¼2-18",
            //    callbackFunction: nameof(this.Training2_NewAssemblyDoc),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "New DrawingDoc",
            //    toolTip: "Í¼2-18",
            //    callbackFunction: nameof(this.Training2_NewDrawingDoc),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "New DrawingDoc",
            //    toolTip: "²½Öè29~31",
            //    callbackFunction: nameof(this.Training2_existingDocs_connectToSolidWorks),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "ToolbarAndCustomProperty",
            //    toolTip: "²½Öè33~35",
            //    callbackFunction: nameof(this.Training2_existingDocs_ToolbarAndCustomProperty),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "µÚ2ÕÂ²½Öè36~38",
            //    toolTip: "",
            //    callbackFunction: nameof(this.Training2_existingDocs_MirrorPart),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "µÚ2ÕÂ²½Öè39~41",
            //    toolTip: "",
            //    callbackFunction: nameof(this.Training2_existingDocs_InsertCavity),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "µÚ2ÕÂ²½Öè42~44",
            //    toolTip: "",
            //    callbackFunction: nameof(this.Training2_existingDocs_CreateLayer),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "µÚ3ÕÂÖ®ÏµÍ³Ñ¡Ïî",
            //    toolTip: "",
            //    callbackFunction: nameof(this.Training3_systemOptions),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "µÚ3ÕÂÖ®ÎÄµµÊôÐÔ",
            //    toolTip: "",
            //    callbackFunction: nameof(this.Training3_documentProperties),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintString: "µÚ4ÕÂÖ®Áã¼þ²ÄÁÏ",
            //    toolTip: "",
            //    callbackFunction: nameof(this.Training4_PartMaterial),
            //    enableMethod: nameof(this.Always),
            //    menuTBOption: swCommandItemType_e.swMenuItem
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ4ÕÂÖ®¾ØÐÎÀ­Éì",
            //    callbackFunction: nameof(this.Training4_rectExtrusion)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ4ÕÂÖ®¾ØÐÎÐý×ª",
            //    callbackFunction: nameof(this.Training4_rectRevolve)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ4ÕÂÖ®Ô²ÐÎÀ­Éì",
            //    callbackFunction: nameof(this.Training4_circleExtrusion)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ4ÕÂÖ®Ô²ÐÎÐý×ª",
            //    callbackFunction: nameof(this.Training4_circleRevolve)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ5ÕÂ",
            //    callbackFunction: nameof(this.Training5_AddComponentsAndMate)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ6ÕÂ",
            //    callbackFunction: nameof(this.Training6)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ7ÕÂ1½Ú",
            //    callbackFunction: nameof(this.Training7_Preselection)
            //    );
            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ7ÕÂ3½Ú",
            //    callbackFunction: nameof(this.Training7_BodyFaceTraversal)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ7ÕÂ4½Ú1~2",
            //    callbackFunction: nameof(this.Training7_FeatMgrTraversal_msg)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ7ÕÂ4½ÚÖ®Ñ¹ËõÔ²½Ç",
            //    callbackFunction: nameof(this.Training7_FeatMgrTraversal_suppress)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ7ÕÂ4½ÚÖ®Òþ²ØÉè¼ÆÊ÷ËùÓÐÌØÕ÷",
            //    callbackFunction: nameof(this.Training7_FeatMgrTraversal_setUIState)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ7ÕÂ4½ÚÖ®Éè¼ÆÊ÷Ö¸¶¨Î»ÖÃµÄÌØÕ÷",
            //    callbackFunction: nameof(this.Training7_FeatMgrTraversal_featureByPositionReverse)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ8ÕÂ",
            //    callbackFunction: nameof(this.Training8_CustomProps_main)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ8ÕÂÊôÐÔ±éÀú",
            //    callbackFunction: nameof(this.Training8_CustomPropertyTraversal)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ8ÕÂÊôÐÔÔÚÅäÖÃÌØ¶¨",
            //    callbackFunction: nameof(this.Training8_CustomPropsConfig)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ8ÕÂÎÄ¼þÕªÒªÐÅÏ¢",
            //    callbackFunction: nameof(this.Training8_CustomFileSummary)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ8ÕÂÎÄµµÌØÐÔ",
            //    callbackFunction: nameof(this.Training8_DocumentAttributes)
            //    );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "µÚ8ÕÂCNCDrilling",
            //    callbackFunction: nameof(this.Training8_CNCDrilling)
            //    );

            //ÃüÁî
            cmds.add(
                hintOrTip: "¸½Â¼D×°ÅäÌå±éÀú",
                callbackFunction: nameof(this.AppendexD_WatchAssemblyTraversal)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "Ïä×Ó",
                callbackFunction: nameof(this.Salon_tank)
                );
            //ÃüÁî
            cmds.add(
                hintOrTip: "ÌáÈ¡Ïä×ÓÊý¾Ý",
                callbackFunction: nameof(this.Salon_tankinfo)
                );
            //ÃüÁî
            cmds.add(
                hintOrTip: "ÅúÁ¿Éú³ÉÏä×Ó",
                callbackFunction: nameof(this.Asia_generate)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "ÅúÁ¿´´½¨²Î¿¼Æ½Ãæ",
                callbackFunction: nameof(this.Asia_createPlanes)
                );

            ////ÃüÁî
            //cmds.add(
            //    hintOrTip: "²åÈëÔ²Öù²Î¿¼ÅäºÏ",
            //    callbackFunction: nameof(this.Ô²ÖùÅäºÏ²Î¿¼)
            //    );

            //ÃüÁî
            cmds.add(
                hintOrTip: "¿âÌØÕ÷",
                callbackFunction: nameof(this.¿âÌØÕ÷)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "Ïä¹ÞÐÅÏ¢",
                callbackFunction: nameof(this.Ïä¹ÞÐÅÏ¢)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "Éú³É¹Ü×ìµÄÅäºÏ²Î¿¼",
                callbackFunction: nameof(this.generateNozzleMateRefs)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "×ø±êÏµ",
                callbackFunction: nameof(this.»ñÈ¡×ø±êÏµ)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "ÊÕ¼¯ËùÓÐ×ø±êÏµ²¢Éú³ÉÅäºÏ²Î¿¼",
                callbackFunction: nameof(this.ÊÕ¼¯ËùÓÐ×ø±êÏµ²¢Éú³ÉÅäºÏ²Î¿¼)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "ÔÚËùÓÐÅäÖÃÒþ²ØÑ¡ÖÐµÄÌØÕ÷",
                callbackFunction: nameof(this.blankSelectedFeatures)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "unblank selectecd features",
                callbackFunction: nameof(this.ÏÔÊ¾ÌØÕ÷)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "¶ÁÈ¡ÎÄ¼þµÄ×Ô¶¨ÒåÊôÐÔ",
                callbackFunction: nameof(this.readCustomProps)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "Ð´ÎÄ¼þµÄ×Ô¶¨ÒåÊôÐÔ",
                callbackFunction: nameof(this.writeCustomProps)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "Ìí¼Ó×é¼þ²¢×ø±êÏµÅäºÏ",
                callbackFunction: nameof(this.addManyCompToCoordSys)
                );

            //ÃüÁî
            cmds.add(
                hintOrTip: "¹ÜµÀ²ÄÁÏÃ÷Ï¸±í",
                callbackFunction: nameof(this.pipeBom)
                );



            // ÃüÁî×é
            var cmdGroup = CommandManagerUtils.createCommandGroup2(
                    userID: cmdGroupID,
                    title: "CuiShengLi",
                    toolTip: "CuiShengLi tool tip",
                    hint: "hint",
                    ignorePreviousVersion: cmds.getUserIDs().SetEquals(CommandManagerUtils.getIDsFromRegistry(cmdGroupID, this.iCmdMgr)),
                    cmdMgr: this.iCmdMgr
                );
            var callingAssy = Assembly.GetAssembly(this.GetType());
            this.iBmp = new BitmapHandler();

            cmdGroup.LargeMainIcon = this.iBmp.CreateFileFromResourceBitmap("SwCSharpAddin1.MainIconLarge.bmp", callingAssy);
            cmdGroup.SmallMainIcon = this.iBmp.CreateFileFromResourceBitmap("SwCSharpAddin1.MainIconSmall.bmp", callingAssy);
            cmdGroup.LargeIconList = this.iBmp.CreateFileFromResourceBitmap("SwCSharpAddin1.ToolbarLarge.bmp", callingAssy);
            cmdGroup.SmallIconList = this.iBmp.CreateFileFromResourceBitmap("SwCSharpAddin1.ToolbarSmall.bmp", callingAssy);

            cmds.update(cmdGroup);

            cmdGroup.HasMenu = true;
            cmdGroup.HasToolbar = false;
            cmdGroup.Activate();

        }

        public void RemoveCommandMgr()
        {
            this.iCmdMgr.RemoveCommandGroup(cmdGroupID);
        }


        //public void Training1()
        //{
        //    training1.exec(this.iSwApp);
        //    //iSwApp.SendMsgToUser("ÕâÊÇÕ¼Î»µÄÃüÁî");

        //    //trainingcylinder.main(iSwApp);

        //    //training2.cmdConnect(iSwApp);
        //    //training2.cmdNewModel_Part(iSwApp);

        //    //training4.testPartMat(iSwApp);
        //    //training4.rectangularExtrude(iSwApp);
        //    //training4.circularExtrude(iSwApp);
        //    //training4.testDrawCirc(iSwApp);
        //    //training4.testCircleContourRevolve(iSwApp);
        //    //training5.testSelectFace(this.iSwApp);

        //    //SldWorksUtils.testCutLists(iSwApp);
        //    //SldWorksUtils.detectCutLists(iSwApp);
        //    //SldWorksUtils.setPartWeldment(iSwApp);

        //}

        public void pipeBom()
        {
            //SWRoutingLibUtils.ExportPipeData(iSwApp);

            //var clss = new Library1.RecursiveTraverseAssembly(iSwApp);
            //clss.Main();

            PipeComponents.PipeUtils.main(this.iSwApp);
        }


        //public void Training2_3()
        //{
        //    training2.connectToSolidWorks(this.iSwApp);
        //}

        //public void Training2_NewModel_Part()
        //{
        //    training2.NewModel_Part(this.iSwApp);
        //}

        //public void Training2_NewModel_ASM()
        //{
        //    training2.NewModel_ASM(this.iSwApp);
        //}

        //public void Training2_NewModel_DRW()
        //{
        //    training2.NewModel_DRW(this.iSwApp);
        //}

        //public void Training2_NewPartDoc()
        //{
        //    training2.NewPartDoc(this.iSwApp);
        //}

        //public void Training2_NewAssemblyDoc()
        //{
        //    training2.NewAssemblyDoc(this.iSwApp);
        //}

        //public void Training2_NewDrawingDoc()
        //{
        //    training2.NewDrawingDoc(this.iSwApp);
        //}

        //public void Training2_existingDocs_connectToSolidWorks()
        //{
        //    training2_existingDocs.connectToSolidWorks(this.iSwApp);
        //}

        //public void Training2_existingDocs_ToolbarAndCustomProperty()
        //{
        //    training2_existingDocs.ToolbarAndCustomProperty(this.iSwApp);
        //}

        //public void Training2_existingDocs_MirrorPart()
        //{
        //    training2_existingDocs.MirrorPart(this.iSwApp);
        //}

        //public void Training2_existingDocs_InsertCavity()
        //{
        //    training2_existingDocs.InsertCavity(this.iSwApp);
        //}

        //public void Training2_existingDocs_CreateLayer()
        //{
        //    training2_existingDocs.CreateLayer(this.iSwApp);
        //}

        //public void Training3_systemOptions()
        //{
        //    training3.systemOptions(this.iSwApp);
        //}

        //public void Training3_documentProperties()
        //{
        //    training3.documentProperties(this.iSwApp);
        //}

        //public void Training4_PartMaterial()
        //{
        //    training4.PartMaterial(this.iSwApp);
        //}

        //public void Training4_rectExtrusion ()
        //{
        //    training4.rectExtrusion(this.iSwApp);
        //}

        //public void Training4_rectRevolve()
        //{
        //    training4.rectRevolve(this.iSwApp);
        //}

        //public void Training4_circleExtrusion()
        //{
        //    training4_circle.circleExtrusion(this.iSwApp);
        //}

        //public void Training4_circleRevolve()
        //{
        //    training4_circle.circleRevolve(this.iSwApp);
        //}

        //public void Training5_AddComponentsAndMate()
        //{
        //    training5.AddComponentsAndMate(this.iSwApp);
        //}

        //public void Training6()
        //{
        //    training6.main(this.iSwApp);
        //}

        //public void Training7_Preselection()
        //{
        //    Preselection.generate(this.iSwApp);
        //}

        //public void Training7_BodyFaceTraversal()
        //{
        //    BodyFaceTraversal.main(this.iSwApp);
        //}

        //public void Training7_FeatMgrTraversal_msg()
        //{
        //    FeatMgrTraversal.msg(this.iSwApp);
        //}

        //public void Training7_FeatMgrTraversal_suppress()
        //{
        //    FeatMgrTraversal.suppress(this.iSwApp);
        //}

        //public void Training7_FeatMgrTraversal_setUIState()
        //{
        //    FeatMgrTraversal.setUIState(this.iSwApp);
        //}

        //public void Training7_FeatMgrTraversal_featureByPositionReverse()
        //{
        //    FeatMgrTraversal.featureByPositionReverse(this.iSwApp);
        //}

        //public void Training8_CustomProps_main()
        //{
        //    CustomProps.main(this.iSwApp);
        //}

        //public void Training8_CustomPropertyTraversal()
        //{
        //    CustomProps.CustomPropertyTraversal(this.iSwApp);
        //}

        //public void Training8_CustomPropsConfig()
        //{
        //    CustomProps.CustomPropsConfig(this.iSwApp);
        //}

        //public void Training8_CustomFileSummary()
        //{
        //    CustomFileSummary.main(this.iSwApp);
        //}

        //public void Training8_DocumentAttributes()
        //{
        //    DocumentAttributes.main(this.iSwApp);
        //}

        //public void Training8_CNCDrilling()
        //{
        //    Training8.CNCDrilling.main(this.iSwApp);
        //}

        public void AppendexD_WatchAssemblyTraversal()
        {
            WatchAssemblyTraversal.main(this.iSwApp);
        }

        public void Salon_tank()
        {
            Salon.tank(this.iSwApp);
        }
        public void Salon_tankinfo()
        {
            Salon.tankinfo(this.iSwApp);
        }
        public void Asia_generate()
        {
            Asia.generate(this.iSwApp);
        }

        public void Asia_createPlanes()
        {
            Asia.createPlanes(this.iSwApp);
        }

        //public void Ô²ÖùÅäºÏ²Î¿¼()
        //{
        //    Asia.preselect(this.iSwApp);
        //}

        public void ¿âÌØÕ÷()
        {
            Asia.getLibraryFeatureData(this.iSwApp);
        }

        public void generateNozzleMateRefs()
        {
            FacesWithFeature.generateNozzleMateRefs(this.iSwApp);
        }

        public void Ïä¹ÞÐÅÏ¢()
        {
            FacesWithFeature.tankInfo(this.iSwApp);
        }

        public void »ñÈ¡×ø±êÏµ()
        {
            CoordinateSystem.getAllOfCoordinateSystems(this.iSwApp);
        }

        public void ÊÕ¼¯ËùÓÐ×ø±êÏµ²¢Éú³ÉÅäºÏ²Î¿¼()
        {
            CoordinateSystem.collectCoordSysMateRefs(this.iSwApp);
        }

        public void blankSelectedFeatures()
        {
            BlankRefGeom.blankSelectedFeatures(this.iSwApp);
        }

        public void ÏÔÊ¾ÌØÕ÷()
        {
            BlankRefGeom.unblankSelectedFeatures(this.iSwApp);
        }

        public void readCustomProps()
        {
            CustomPropsApp.readCustomProps(this.iSwApp);
        }

        public void writeCustomProps()
        {
            CustomPropsApp.writeCustomProps(this.iSwApp);
        }

        public void addManyCompToCoordSys()
        {
            CoordinateSystem.addManyCompToCoordSys(this.iSwApp);
        }

        public bool Always() { return true; }
    }

}
